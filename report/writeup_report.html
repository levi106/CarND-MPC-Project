<h1><strong>Model Predictive Control</strong></h1>
<p><strong>Model Predictive Control Project</strong></p>
<ol>
<li>Clone/fork the project's template files from the project repository. (Note: Please do not submit your project as a pull request against our repo!)</li>
<li>Choose your state, input(s), dynamics, constraints and implement MPC.</li>
<li>Test your solution on basic examples.</li>
<li>Test your solution on the simulator!</li>
<li>When the vehicle is able to drive successfully around the track, submit! Remember to include a separate file in .txt, .md, .html, or .pdf format addressing the questions in the rubric.</li>
<li>Try to see how fast you get the vehicle to SAFELY go!</li>
</ol>
<h2>Rubic Points</h2>
<h3>Here I will consider the <a href="https://review.udacity.com/#!/rubrics/896/view">rubic points</a> individually and describe how I addressed each point in my implementation.</h3>
<hr>
<h3>Compilation</h3>
<h4>1. Code must complile without errors with <code>cmake</code> and <code>make</code>.</h4>
<p>My code could be compiled without errors.</p>
<p>To enable debugging, I appended the following line to CMakeLists.txt:</p>
<pre><code class="language-cmake">set(CMAKE_BUILD_TYPE Debug)
</code></pre>
<h3>Implementation</h3>
<h4>2. Student describes their model in detail. This includes the state, actuators and update equations.</h4>
<h4>3. Student discusses the reasoning behind the chosen <code>N</code> and <code>dt</code> values.</h4>
<p>First I selected the same N and dt values as Lesson 19 (i.e. N = 25 and dt = 0.05).</p>
<p><img src="./25_5_cte.png" alt="alt text" title="25 5 cte">
<img src="./25_5_delta.png" alt="alt text" title="25 5 delta"></p>
<p><img src="./10_15_cte.png" alt="alt text" title="10 15 cte">
<img src="./10_15_delta.png" alt="alt text" title="10 15 delta"></p>
<h4>4. A polynomial is fitted to waypoints.</h4>
<p><strong>waypoints</strong></p>
<p>I converted the positions of the waypoints to the vehicles' coordinate system (main.cpp l.110):</p>
<pre><code class="language-cpp">vector&lt;double&gt; v_ptsx;
vector&lt;double&gt; v_ptsy;
for (size_t i = 0; i &lt; ptsx.size(); i++) {
    double dx = ptsx[i] - px;
    double dy = ptsy[i] - py;
    v_ptsx.push_back(dx * cos(-psi) - dy * sin(-psi));
    v_ptsy.push_back(dx * sin(-psi) + dy * cos(-psi));
}
</code></pre>
<p><strong>the vehicle state</strong></p>
<p>Because of conversion to the vehicle coordinate system, x, y and phi of the vehicle state are 0. Also, the fitting polynomial, cte and epsi are calcuated with the following code (main.cpp l.119):</p>
<pre><code class="language-cpp">auto coeffs = polyfit(Eigen::Map&lt;Eigen::VectorXd&gt;(&amp;v_ptsx[0],v_ptsx.size()),
                    Eigen::Map&lt;Eigen::VectorXd&gt;(&amp;v_ptsy[0],v_ptsy.size()), 3);
double cte = polyeval(coeffs, 0);
double epsi = - atan(coeffs[1]);
</code></pre>
<p>As a point of note, the speed is in mph, I converted it to mps with the following code (main.cpp l.19, l.95):</p>
<pre><code class="language-cpp">double mph2mps(double v) { return v * 0.44704; }
double v = mph2mps(j[1][&quot;speed&quot;]);
</code></pre>
<h4>5. The student implements Model Predictive Control that handles a 100 millisecond latency.</h4>
<p>I predicted the position of the car after 100 milliseconds by the following calculation:</p>
<p>$$dt = 0.1$$
$$x' = x + v \times \cos(\psi) \times dt$$
$$y' = y + v \times \sin(\psi) \times dt$$
$$\psi' = \psi - (v / Lf) \times \delta \times dt$$
$$v' = v + a \times dt$$</p>
<p>The following is the actual code (main.cpp l.90):</p>
<pre><code class="language-cpp">double dt = 0.1;
vector&lt;double&gt; ptsx = j[1][&quot;ptsx&quot;];
vector&lt;double&gt; ptsy = j[1][&quot;ptsy&quot;];
double px = j[1][&quot;x&quot;];
double py = j[1][&quot;y&quot;];
double psi = j[1][&quot;psi&quot;];
double v = mph2mps(j[1][&quot;speed&quot;]);
double steering_angle = j[1][&quot;steering_angle&quot;];
double throttle = j[1][&quot;throttle&quot;];
px += v * cos(psi) * dt;
py += v * sin(psi) * dt;
psi -= (v / MPC::Lf) * steering_angle * dt;
v += throttle * dt;
</code></pre>
<h3>Simulation</h3>
<h4>6. The vehicle must successfully drive a lap around the track.</h4>
<p>The car did not pop up onto ledges or roll over any surface.</p>
